<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <title>黑金喵農場</title>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <style>
    .show {
       transition: opacity 0.01ms;
    }
   .space { 
    margin:0; padding:0; height:300px; 
    }
    .img-wrapper {
        position: relative;
        display: inline-block;
    }

    .background-img {
        width: 100%;
        height: auto;
    }

    .foreground-img {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px; /* 固定寬度，例如 150px，可以依據你的需求調整 */
        height: 50px; /* 固定高度，例如 150px，可以依據你的需求調整 */
        object-fit: contain; /* 保持圖片的比例，不會變形 */
        display: block;
        margin: 0 auto; /* 將圖片置中 */
    }
</style>
</head>
<body>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!--頂端清單-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand fs-1" href="catHero_index.html" id="top">&nbsp&nbsp黑金喵農場</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse fs-4" id="navbarNav">
        <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" href="https://reurl.cc/K4yxAe">遊戲各項資訊</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="https://discord.gg/quE8qjjzXW">加入DC群</a>
        </li>
        </ul>
    </div>
    </nav>
    <div class="space"></div>
        <div class="d-flex justify-content-center">
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">Start!</button></div>
        </div>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Game Timer: <span id="timer">30</span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row row-cols-3 g-4">
                        <div class="col">
                            <div class="img-wrapper">
                                <img src="" alt="" class="img-thumbnail background-img" onclick="imageClicked(this)">
                                <img src="" alt="" class="foreground-img" onclick="imageClicked(this)">
                            </div>
                        </div>
                        <div class="col">
                            <div class="img-wrapper">
                                <img src="" alt="" class="img-thumbnail background-img" onclick="imageClicked(this)">
                                <img src="" alt="" class="foreground-img" onclick="imageClicked(this)">
                            </div>
                        </div>
                        <div class="col">
                            <div class="img-wrapper">
                                <img src="" alt="" class="img-thumbnail background-img" onclick="imageClicked(this)">
                                <img src="" alt="" class="foreground-img" onclick="imageClicked(this)">
                            </div>
                        </div>
                        <div class="col">
                            <div class="img-wrapper">
                                <img src="" alt="" class="img-thumbnail background-img" onclick="imageClicked(this)">
                                <img src="" alt="" class="foreground-img" onclick="imageClicked(this)">
                            </div>
                        </div>
                        <div class="col">
                            <div class="img-wrapper">
                                <img src="" alt="" class="img-thumbnail background-img" onclick="imageClicked(this)">
                                <img src="" alt="" class="foreground-img" onclick="imageClicked(this)">
                            </div>
                        </div>
                        <div class="col">
                            <div class="img-wrapper">
                                <img src="" alt="" class="img-thumbnail background-img" onclick="imageClicked(this)">
                                <img src="" alt="" class="foreground-img" onclick="imageClicked(this)">
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous"></script>

    <script>
        const backgrounds = Array.from({ length: 27 }, (_, i) => `path/to/training/background${i + 1}.png`);
        const weapons = Array.from({ length: 23 }, (_, i) => `path/to/training/weapon${i}.png`);
        const skills = Array.from({ length: 23 }, (_, i) => `path/to/training/skill${i + 1}.png`);
        const armors = Array.from({ length: 30 }, (_, i) => `path/to/training/armor${i + 1}.png`);
        const ridings = Array.from({ length: 24 }, (_, i) => `path/to/training/riding${i + 1}.png`);
        const pets = Array.from({ length: 57 }, (_, i) => `path/to/training/pet${i + 1}.png`);

        function loadImages() {
            const imgWrappers = document.querySelectorAll('.img-wrapper');
            let availableBackgrounds = [...backgrounds];
            const foregroundCategories = [weapons, skills, armors, ridings, pets];

            // 隨機選擇兩個不同的種類作為前景圖片的來源
            const primaryCategoryIndex = Math.floor(Math.random() * foregroundCategories.length);
            let secondaryCategoryIndex;
            do {
                secondaryCategoryIndex = Math.floor(Math.random() * foregroundCategories.length);
            } while (secondaryCategoryIndex === primaryCategoryIndex);

            const primaryCategory = [...foregroundCategories[primaryCategoryIndex]];
            const secondaryCategory = [...foregroundCategories[secondaryCategoryIndex]];

            // 設定隨機背景圖片
            imgWrappers.forEach(wrapper => {
                const backgroundImg = wrapper.querySelector('.background-img');
                const randomBackgroundIndex = Math.floor(Math.random() * availableBackgrounds.length);
                backgroundImg.src = availableBackgrounds[randomBackgroundIndex];
                availableBackgrounds.splice(randomBackgroundIndex, 1);
            });

            // 設定前景圖片：5 張來自 primaryCategory，1 張來自 secondaryCategory
            let selectedImages = [];
            for (let i = 0; i < 5; i++) {
                const randomIndex = Math.floor(Math.random() * primaryCategory.length);
                selectedImages.push(primaryCategory[randomIndex]);
                primaryCategory.splice(randomIndex, 1);
            }

            // 隨機選擇一張圖片作為不同種類的圖片
            const randomSecondaryIndex = Math.floor(Math.random() * secondaryCategory.length);
            const uniqueImage = secondaryCategory[randomSecondaryIndex];
            selectedImages.push(uniqueImage);

            // 隨機打亂前景圖片的順序
            selectedImages = selectedImages.sort(() => Math.random() - 0.5);

            // 設定前景圖片並添加點擊事件
            imgWrappers.forEach((wrapper, index) => {
                const foregroundImg = wrapper.querySelector('.foreground-img');
                const backgroundImg = wrapper.querySelector('.background-img');

                // 設定前景圖片的來源
            foregroundImg.src = selectedImages[index];
            
            // 定義點擊事件處理
            const handleClick = () => {
                if (foregroundImg.src.includes(uniqueImage)) {
                    alert('Complete!');
                    setTimeout(loadImages, 100);
                    startTimer();
                } else {
                    alert('Miss!');
                }
            };

            // 為前景圖片添加點擊事件
            foregroundImg.onclick = handleClick;
            
            // 為背景圖片添加點擊事件
            backgroundImg.onclick = handleClick;
            });
        }

        // 當 modal 顯示時載入圖片
        $('#exampleModal').on('show.bs.modal', loadImages);

        let countdown;
        let timeLeft = 30;

        // 啟動計時器
        function startTimer() {
            timeLeft = 30;
            document.getElementById('timer').textContent = timeLeft;
            
            // 清除之前的計時器
            clearInterval(countdown);
            
            countdown = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;

                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    alert('Time is up!');
                    loadImages();  // 時間到時重新載入圖片
                    startTimer();  // 重新啟動計時器
                }
            }, 1000);
        }

        // 停止計時器
        function stopTimer() {
            clearInterval(countdown);
        }

        // 當 modal 顯示時啟動計時器
        $('#exampleModal').on('show.bs.modal', () => {
            startTimer();
            loadImages(); // 每次顯示 modal 時重新載入圖片
        });

        // 當 modal 關閉時停止計時器
        $('#exampleModal').on('hide.bs.modal', () => {
            stopTimer();
        });

    </script>
    
</body>
</html>
